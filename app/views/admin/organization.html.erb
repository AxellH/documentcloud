<style type="text/css">
  .stat {
    font-weight: bold;
    white-space: nowrap;
  }
</style>

<div class="container-md content paper">
  <section class="mt-4 mb-5">
    <%= link_to 'Edit', admin_edit_organization_path(slug: @organization.slug), class: 'btn btn-sm btn-primary float-right ml-1 mb-1' %>
    <p>
      <b><%= @organization.name %></b> joined <%= time_ago_in_words(@organization.created_at) %> ago on <b class="text-muted bg-faded"><%= @organization.created_at.strftime("%B %d, %Y") %></b>. It has <span class="stat"><%= "#{@member_count} member".pluralize(@member_count) %></span> (including <span class="stat"><%= "#{@admin_count} administrator".pluralize(@admin_count) %></span>).
      Since <% if @organization.created_at == @since %>then'<%else%><b class="text-muted bg-faded"><%=@since.strftime("%B %d, %Y") %></b><% end %>, <span class="stat"><%= "#{number_with_delimiter(@document_count)} document".pluralize(@document_count) %></span> have been uploaded (<%= number_with_delimiter(@public_count) %> public, <%= number_with_delimiter(@private_count) %> private), which have received <span class="stat"><%= number_with_delimiter(@hit_count) %> views</span> (<%= link_to 'download CSV', admin_download_document_hits_path(slug: @organization.slug), class: 'btn-link-inline' %>).
    </p>
  </section>
  <section class="mb-5">
    <table class="table table-striped sortable">
      <thead>
        <tr>
          <th data-sort="string-ins">Top <%= @top_count %> Uploaders</th>
          <th data-sort="string-ins">Email</th>
          <th data-sort="int">Documents</th>
        </tr>
      </thead>
      <tbody>
      <% @top_uploaders.each do |account, count| %>
        <tr>
          <td><%= account.full_name %></td>
          <td><%= mail_to account.email %></td>
          <td><%= link_to count, "/search/Account:#{account.slug}", class: 'btn btn-sm btn-primary', target: '_blank' %></td>
        </tr>
      <% end %>
      </tbody>
    </table>
  </section>
  <section>
    <table class="table table-striped sortable">
      <thead>
        <tr>
          <th data-sort="string-ins">Administrators</th>
          <th data-sort="string-ins">Email</th>
          <th data-sort="int">Age</th>
        </tr>
      </thead>
      <tbody>
      <% @administrators.each do |account| %>
        <tr>
          <td><%= account.full_name %></td>
          <td><%= mail_to account.email %></td>
          <td data-sort-value="<%= account.created_at.to_i %>"><%= time_ago_in_words account.created_at %></td>
        </tr>
      <% end %>
      </tbody>
    </table>
  </section>
</div>

<% content_for :javascript_footer_inline do %>
  $('.sortable').stupidtable();
<% end %>
